<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="qtable">
<!-- 게시판 글쓸때 정보를 insert -->
<insert id="addNoticeInfo" parameterType="kr.co.korea.beans.QtableBean">
<selectKey keyProperty="q_idx" order="BEFORE" resultType="java.lang.Integer">
	select q_table_seq.nextval from dual
</selectKey>
	
<include refid="filecheck"></include>
</insert>

<sql id="filecheck">
	<if test="q_file != null">
		insert into q_table(q_idx, q_title, q_content,q_pwd,q_file, q_name, q_date)
values(#{q_idx}, #{q_title}, #{q_content},#{q_pwd}, #{q_file}, #{q_name}, sysdate)
	</if>
	<if test="q_file == null">
	insert into q_table(q_idx, q_title, q_content,q_pwd, q_name, q_date)
values(#{q_idx}, #{q_title}, #{q_content},#{q_pwd}, #{q_name}, sysdate)
	</if>
</sql>

<select id="getNoticeList" resultType="kr.co.korea.beans.QtableBean">
<![CDATA[
	select q_idx,q_title,q_name,
	to_char(q_date,'YYYY-MM-DD')as 
	q_date,q_hit,q_content,q_file from q_table order by q_idx desc
]]>
</select>

<select id="getNoticeInfo"  resultType="kr.co.korea.beans.QtableBean">
<![CDATA[
	select  q_idx,q_title,q_name,
	to_char(q_date,'YYYY-MM-DD')as 
	q_date,q_hit,q_content,q_file,q_pwd from q_table where q_idx=#{q_idx}
]]>
</select>

<select id="getEditNoticeInfo" parameterType="kr.co.korea.beans.QtableBean" resultType="kr.co.korea.beans.QtableBean">
<![CDATA[
	select  q_idx,q_title,q_name,
	to_char(q_date,'YYYY-MM-DD')as 
	q_date,q_hit,q_content,q_file,q_pwd from q_table where q_idx=#{q_idx}
]]>
</select>


<update id="editNoticeInfo" parameterType="kr.co.korea.beans.QtableBean" >
<![CDATA[
	update q_table
	set q_title=#{q_title} ,q_name=#{q_name},
	q_content=#{q_content},q_file=#{q_file} where q_idx=#{q_idx} 
]]>

</update>

<delete id="deleteNoticeInfo" parameterType="java.lang.Integer">
<![CDATA[
delete from q_table
where q_idx=#{q_idx} 
]]>

</delete>

</mapper>

